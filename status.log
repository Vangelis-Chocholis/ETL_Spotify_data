<<<<<<< HEAD
=======
<<<<<<< HEAD
=======
2023-12-29 20:14:25,681 - ERROR - An exception occurred: get artist_ids, album_ids, track_ids lists
2023-12-29 20:14:25,681 - ERROR - An exception occurred: Load data into DB
2023-12-29 20:14:53,609 - ERROR - An exception occurred: get artist_ids, album_ids, track_ids lists
2023-12-29 20:14:53,609 - ERROR - An exception occurred: Load data into DB
2023-12-29 20:15:23,292 - INFO - Code executed successfully!
2023-12-29 20:34:52,922 - INFO - Code executed successfully!
2023-12-29 20:44:07,583 - INFO - Code executed successfully!
2023-12-29 20:48:03,842 - INFO - Code executed successfully!
2023-12-29 20:55:35,405 - INFO - Code executed successfully!
2023-12-29 20:56:15,777 - INFO - Code executed successfully!
2023-12-29 22:09:17,545 - ERROR - An exception occurred: get artist_ids, album_ids, track_ids lists
2023-12-29 22:09:17,545 - ERROR - An exception occurred: Load data into DB
2023-12-29 22:33:44,443 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/5)
2023-12-29 22:33:49,449 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 2/5)
2023-12-29 22:33:54,450 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 3/5)
2023-12-29 22:33:59,456 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 4/5)
2023-12-29 22:34:04,461 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 5/5)
2023-12-29 22:34:09,467 - ERROR - Failed to get Spotify ids  after 5 attempts.
2023-12-29 22:34:09,467 - ERROR - An exception occurred: Load data into DB
2023-12-29 23:09:53,373 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/2)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.Error: ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'ODBC Driver 18 for SQL Server' : file not found (0) (SQLDriverConnect)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 57, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.DBAPIError: (pyodbc.Error) ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'ODBC Driver 18 for SQL Server' : file not found (0) (SQLDriverConnect)")
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2023-12-29 23:09:58,381 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 2/2)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.Error: ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'ODBC Driver 18 for SQL Server' : file not found (0) (SQLDriverConnect)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 57, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.DBAPIError: (pyodbc.Error) ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'ODBC Driver 18 for SQL Server' : file not found (0) (SQLDriverConnect)")
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2023-12-29 23:10:03,386 - ERROR - Failed to get Spotify ids  after 2 attempts.
2023-12-29 23:10:03,386 - ERROR - An exception occurred: Load data into DB
2023-12-29 23:34:15,671 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/2)
2023-12-29 23:34:20,677 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 2/2)
2023-12-29 23:34:25,682 - ERROR - Failed to get Spotify ids  after 2 attempts.
2023-12-29 23:34:25,682 - ERROR - An exception occurred: Load data into DB
2023-12-30 02:18:14,941 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/1)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.Error: ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'ODBC Driver 18 for SQL Server' : file not found (0) (SQLDriverConnect)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 57, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.DBAPIError: (pyodbc.Error) ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'ODBC Driver 18 for SQL Server' : file not found (0) (SQLDriverConnect)")
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2023-12-30 02:18:19,949 - ERROR - Failed to get Spotify ids  after 1 attempts.
2023-12-30 02:18:19,949 - ERROR - An exception occurred: Load data into DB
2023-12-30 04:01:59,668 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/1)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.Error: ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'ODBC Driver 18 for SQL Server' : file not found (0) (SQLDriverConnect)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 57, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.DBAPIError: (pyodbc.Error) ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'ODBC Driver 18 for SQL Server' : file not found (0) (SQLDriverConnect)")
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2023-12-30 04:02:04,675 - ERROR - Failed to get Spotify ids  after 1 attempts.
2023-12-30 04:02:04,675 - ERROR - An exception occurred: Load data into DB
2023-12-30 04:08:57,495 - INFO - driver
2023-12-30 04:11:42,655 - INFO - ODBC Driver 17 for SQL Server
2023-12-30 04:14:32,826 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/1)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.OperationalError: ('HYT00', '[HYT00] [unixODBC][Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 57, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.OperationalError: (pyodbc.OperationalError) ('HYT00', '[HYT00] [unixODBC][Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2023-12-30 04:14:37,834 - ERROR - Failed to get Spotify ids  after 1 attempts.
2023-12-30 04:14:37,834 - ERROR - An exception occurred: Load data into DB
2023-12-30 04:18:12,326 - ERROR - An exception occurred: Load data into DB
2023-12-30 04:22:02,096 - ERROR - An exception occurred: Load data into DB
2023-12-30 04:30:48,202 - ERROR - An exception occurred: Load data into DB
2023-12-30 04:38:16,168 - ERROR - An exception occurred: SQLAlcehmy engine error (Attempt 1/5)
2023-12-30 04:38:21,173 - ERROR - An exception occurred: SQLAlcehmy engine error (Attempt 2/5)
2023-12-30 04:38:26,178 - ERROR - An exception occurred: SQLAlcehmy engine error (Attempt 3/5)
2023-12-30 04:38:31,183 - ERROR - An exception occurred: SQLAlcehmy engine error (Attempt 4/5)
2023-12-30 04:38:36,189 - ERROR - An exception occurred: SQLAlcehmy engine error (Attempt 5/5)
2023-12-30 04:38:41,194 - ERROR - Failed to create the SQLAlchemy engine after 5 attempts.
2023-12-30 04:38:41,261 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/1)
Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 59, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 654, in read_sql
    return pandas_sql.read_query(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 2326, in read_query
    cursor = self.execute(sql, params)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 2260, in execute
    cur = self.con.cursor()
AttributeError: 'NoneType' object has no attribute 'cursor'
2023-12-30 04:38:46,266 - ERROR - Failed to get Spotify ids  after 1 attempts.
2023-12-30 04:38:46,267 - ERROR - An exception occurred: Load data into DB
2023-12-30 04:43:05,774 - ERROR - An exception occurred: SQLAlcehmy engine error (Attempt 1/5)
Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 38, in set_engine
    connection_url = URL.create("mssql+pyodbc", query={"odbc_connect": connection_string})
NameError: name 'URL' is not defined
2023-12-30 04:43:10,779 - ERROR - An exception occurred: SQLAlcehmy engine error (Attempt 2/5)
Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 38, in set_engine
    connection_url = URL.create("mssql+pyodbc", query={"odbc_connect": connection_string})
NameError: name 'URL' is not defined
2023-12-30 04:43:15,784 - ERROR - An exception occurred: SQLAlcehmy engine error (Attempt 3/5)
Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 38, in set_engine
    connection_url = URL.create("mssql+pyodbc", query={"odbc_connect": connection_string})
NameError: name 'URL' is not defined
2023-12-30 04:43:20,790 - ERROR - An exception occurred: SQLAlcehmy engine error (Attempt 4/5)
Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 38, in set_engine
    connection_url = URL.create("mssql+pyodbc", query={"odbc_connect": connection_string})
NameError: name 'URL' is not defined
2023-12-30 04:43:25,793 - ERROR - An exception occurred: SQLAlcehmy engine error (Attempt 5/5)
Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 38, in set_engine
    connection_url = URL.create("mssql+pyodbc", query={"odbc_connect": connection_string})
NameError: name 'URL' is not defined
2023-12-30 04:43:30,798 - ERROR - Failed to create the SQLAlchemy engine after 5 attempts.
2023-12-30 04:43:30,802 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/1)
2023-12-30 04:43:35,807 - ERROR - Failed to get Spotify ids  after 1 attempts.
2023-12-30 04:43:35,807 - ERROR - An exception occurred: Load data into DB
2023-12-30 04:45:37,913 - ERROR - An exception occurred: Load data into DB
2023-12-30 04:48:05,641 - ERROR - An exception occurred: Load data into DB
2023-12-30 04:52:36,313 - ERROR - An exception occurred: Load data into DB
2023-12-30 13:06:43,602 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/1)
2023-12-30 13:06:48,607 - ERROR - Failed to get Spotify ids  after 1 attempts.
2023-12-30 13:06:48,607 - ERROR - An exception occurred: Load data into DB
2023-12-30 13:10:14,185 - ERROR - An exception occurred: Load data into DB
2023-12-30 13:13:07,903 - ERROR - An exception occurred: Load data into DB
2023-12-30 13:31:00,345 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/1)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.Error: ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'ODBC Driver 17 for SQL Server' : file not found (0) (SQLDriverConnect)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 57, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.DBAPIError: (pyodbc.Error) ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'ODBC Driver 17 for SQL Server' : file not found (0) (SQLDriverConnect)")
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2023-12-30 13:31:05,352 - ERROR - Failed to get Spotify ids  after 1 attempts.
2023-12-30 13:31:05,353 - ERROR - An exception occurred: Load data into DB
2023-12-30 13:48:05,560 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/1)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.OperationalError: ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 57, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.OperationalError: (pyodbc.OperationalError) ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2023-12-30 13:48:10,568 - ERROR - Failed to get Spotify ids  after 1 attempts.
2023-12-30 13:48:10,568 - ERROR - An exception occurred: Load data into DB
2023-12-30 13:49:43,616 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/1)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.Error: ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'ODBC Driver 18 for SQL Server' : file not found (0) (SQLDriverConnect)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 57, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.DBAPIError: (pyodbc.Error) ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'ODBC Driver 18 for SQL Server' : file not found (0) (SQLDriverConnect)")
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2023-12-30 13:49:48,624 - ERROR - Failed to get Spotify ids  after 1 attempts.
2023-12-30 13:49:48,624 - ERROR - An exception occurred: Load data into DB
2023-12-30 17:39:13,207 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/1)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.OperationalError: ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 57, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.OperationalError: (pyodbc.OperationalError) ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2023-12-30 17:39:18,214 - ERROR - Failed to get Spotify ids  after 1 attempts.
2023-12-30 17:39:18,214 - ERROR - An exception occurred: Load data into DB
2023-12-30 18:14:02,837 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/1)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.Error: ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'SQL Server' : file not found (0) (SQLDriverConnect)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 58, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.DBAPIError: (pyodbc.Error) ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'SQL Server' : file not found (0) (SQLDriverConnect)")
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2023-12-30 18:14:07,844 - ERROR - Failed to get Spotify ids  after 1 attempts.
2023-12-30 18:14:07,845 - ERROR - An exception occurred: Load data into DB
2023-12-30 18:36:03,749 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/1)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.Error: ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'SQL Server' : file not found (0) (SQLDriverConnect)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 68, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.DBAPIError: (pyodbc.Error) ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'SQL Server' : file not found (0) (SQLDriverConnect)")
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2023-12-30 18:36:08,757 - ERROR - Failed to get Spotify ids  after 1 attempts.
2023-12-30 18:36:08,757 - ERROR - An exception occurred: Load data into DB
2023-12-30 18:40:28,076 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/1)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.OperationalError: ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 68, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.OperationalError: (pyodbc.OperationalError) ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2023-12-30 18:40:33,084 - ERROR - Failed to get Spotify ids  after 1 attempts.
2023-12-30 18:40:33,084 - ERROR - An exception occurred: Load data into DB
2023-12-30 18:57:09,276 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/1)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.OperationalError: ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 68, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.OperationalError: (pyodbc.OperationalError) ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2023-12-30 18:57:14,281 - ERROR - Failed to get Spotify ids  after 1 attempts.
2023-12-30 18:57:14,283 - ERROR - An exception occurred: Load data into DB
>>>>>>> 0863fb41ae6ffa2fda95a8d89a6d59b2838d1ad3
2023-12-30 19:50:09,250 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/2)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.OperationalError: ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 69, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.OperationalError: (pyodbc.OperationalError) ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2023-12-30 19:50:26,746 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 2/2)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.OperationalError: ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 69, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.OperationalError: (pyodbc.OperationalError) ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2023-12-30 19:50:28,748 - ERROR - Failed to get Spotify ids  after 2 attempts.
2023-12-30 19:50:28,749 - ERROR - An exception occurred: Load data into DB
2023-12-30 19:53:54,629 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/2)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.Error: ('01000', '[01000] [unixODBC][Driver Manager]Can\'t open lib \'SQL Server Native Client 11.0"\' : file not found (0) (SQLDriverConnect)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 69, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.DBAPIError: (pyodbc.Error) ('01000', '[01000] [unixODBC][Driver Manager]Can\'t open lib \'SQL Server Native Client 11.0"\' : file not found (0) (SQLDriverConnect)')
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2023-12-30 19:53:56,634 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 2/2)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.Error: ('01000', '[01000] [unixODBC][Driver Manager]Can\'t open lib \'SQL Server Native Client 11.0"\' : file not found (0) (SQLDriverConnect)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 69, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.DBAPIError: (pyodbc.Error) ('01000', '[01000] [unixODBC][Driver Manager]Can\'t open lib \'SQL Server Native Client 11.0"\' : file not found (0) (SQLDriverConnect)')
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2023-12-30 19:53:58,637 - ERROR - Failed to get Spotify ids  after 2 attempts.
2023-12-30 19:53:58,637 - ERROR - An exception occurred: Load data into DB
2023-12-30 19:55:52,372 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/2)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.Error: ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'SQL Server Native Client 11.0' : file not found (0) (SQLDriverConnect)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 69, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.DBAPIError: (pyodbc.Error) ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'SQL Server Native Client 11.0' : file not found (0) (SQLDriverConnect)")
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2023-12-30 19:55:54,374 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 2/2)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.Error: ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'SQL Server Native Client 11.0' : file not found (0) (SQLDriverConnect)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 69, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.DBAPIError: (pyodbc.Error) ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'SQL Server Native Client 11.0' : file not found (0) (SQLDriverConnect)")
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2023-12-30 19:55:56,377 - ERROR - Failed to get Spotify ids  after 2 attempts.
2023-12-30 19:55:56,377 - ERROR - An exception occurred: Load data into DB
2023-12-30 20:00:48,243 - ERROR - An exception occurred: Load data into DB
2023-12-30 20:18:11,589 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/2)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.OperationalError: ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 70, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.OperationalError: (pyodbc.OperationalError) ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2023-12-30 20:18:28,709 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 2/2)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.OperationalError: ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 70, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.OperationalError: (pyodbc.OperationalError) ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2023-12-30 20:18:30,711 - ERROR - Failed to get Spotify ids  after 2 attempts.
2023-12-30 20:18:30,711 - ERROR - An exception occurred: Load data into DB
2023-12-30 20:20:55,984 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/2)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.OperationalError: ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 70, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.OperationalError: (pyodbc.OperationalError) ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2023-12-30 20:21:13,105 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 2/2)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.OperationalError: ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 70, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.OperationalError: (pyodbc.OperationalError) ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2023-12-30 20:21:15,107 - ERROR - Failed to get Spotify ids  after 2 attempts.
2023-12-30 20:21:15,107 - ERROR - An exception occurred: Load data into DB
>>>>>>> b882fb3b9f85c51833fa62aa718f70d267e6656a
2023-12-30 21:55:32,637 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 1/2)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.Error: ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'ODBC Driver 18 for SQL Server' : file not found (0) (SQLDriverConnect)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 70, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.DBAPIError: (pyodbc.Error) ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'ODBC Driver 18 for SQL Server' : file not found (0) (SQLDriverConnect)")
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2023-12-30 21:55:34,641 - ERROR - An exception occurred: failed to get Spotify ids (Attempt 2/2)
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
pyodbc.Error: ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'ODBC Driver 18 for SQL Server' : file not found (0) (SQLDriverConnect)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/runner/work/spotify_daily_data_updates/spotify_daily_data_updates/main.py", line 70, in get_spotify_ids
    artist_ids = pd.read_sql(query, engine)['artist_id'].to_list()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 652, in read_sql
    with pandasSQL_builder(con) as pandas_sql:
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 851, in pandasSQL_builder
    return SQLDatabase(con, schema, need_transaction)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1576, in __init__
    con = self.exit_stack.enter_context(con.connect())
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3269, in connect
    return self._connection_cls(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2431, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3293, in raw_connection
    return self.pool.connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 170, in _do_get
    self._dec_overflow()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 903, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 645, in connect
    return dialect.connect(*cargs, **cparams)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
sqlalchemy.exc.DBAPIError: (pyodbc.Error) ('01000', "[01000] [unixODBC][Driver Manager]Can't open lib 'ODBC Driver 18 for SQL Server' : file not found (0) (SQLDriverConnect)")
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2023-12-30 21:55:36,643 - ERROR - Failed to get Spotify ids  after 2 attempts.
2023-12-30 21:55:36,644 - ERROR - An exception occurred: Load data into DB
