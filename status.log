2024-01-04 01:39:10,516 - INFO - The database has been updated successfully!
2024-01-05 01:39:57,771 - INFO - The database has been updated successfully!
2024-01-06 01:38:25,567 - INFO - The database has been updated successfully!
2024-01-07 01:45:31,644 - INFO - The database has been updated successfully!
2024-01-08 01:41:33,392 - INFO - The database has been updated successfully!
2024-01-09 01:41:17,545 - INFO - The database has been updated successfully!
2024-01-10 01:41:02,895 - INFO - The database has been updated successfully!
2024-01-11 01:41:48,784 - INFO - The database has been updated successfully!
2024-01-12 01:41:55,523 - INFO - The database has been updated successfully!
2024-01-13 01:40:28,993 - INFO - The database has been updated successfully!
2024-01-14 01:46:20,070 - INFO - The database has been updated successfully!
2024-01-15 01:44:04,099 - INFO - The database has been updated successfully!
2024-01-16 01:41:17,503 - INFO - The database has been updated successfully!
2024-01-17 01:41:36,136 - INFO - The database has been updated successfully!
2024-01-18 01:40:45,131 - INFO - The database has been updated successfully!
2024-01-19 01:41:58,565 - INFO - The database has been updated successfully!
2024-01-20 01:39:43,405 - INFO - The database has been updated successfully!
2024-01-21 01:46:49,280 - INFO - The database has been updated successfully!
2024-01-22 01:45:13,370 - INFO - The database has been updated successfully!
2024-01-23 01:43:26,115 - INFO - The database has been updated successfully!
2024-01-24 01:42:48,371 - INFO - The database has been updated successfully!
2024-01-25 01:43:24,395 - INFO - The database has been updated successfully!
2024-01-26 01:35:23,861 - INFO - The database has been updated successfully!
2024-01-27 01:32:23,818 - INFO - The database has been updated successfully!
2024-01-28 01:38:00,192 - INFO - The database has been updated successfully!
2024-01-29 01:33:08,981 - INFO - The database has been updated successfully!
2024-01-30 01:33:24,382 - INFO - The database has been updated successfully!
2024-01-31 01:34:14,341 - INFO - The database has been updated successfully!
2024-02-01 01:38:06,194 - INFO - The database has been updated successfully!
2024-02-02 01:34:02,540 - INFO - The database has been updated successfully!
2024-02-03 01:31:36,881 - INFO - The database has been updated successfully!
2024-02-04 01:38:17,925 - INFO - The database has been updated successfully!
2024-02-05 01:37:05,700 - INFO - The database has been updated successfully!
2024-02-06 01:33:26,937 - INFO - The database has been updated successfully!
2024-02-07 01:32:01,387 - INFO - The database has been updated successfully!
2024-02-08 01:32:38,545 - INFO - The database has been updated successfully!
2024-02-09 01:32:22,853 - INFO - The database has been updated successfully!
2024-02-10 01:31:06,517 - INFO - The database has been updated successfully!
2024-02-11 01:38:30,719 - INFO - The database has been updated successfully!
2024-02-12 01:33:51,981 - INFO - The database has been updated successfully!
2024-02-13 01:33:55,267 - INFO - The database has been updated successfully!
2024-02-14 01:34:25,767 - INFO - The database has been updated successfully!
2024-02-15 01:34:17,072 - INFO - The database has been updated successfully!
2024-02-16 01:33:31,430 - INFO - The database has been updated successfully!
2024-02-17 01:32:00,931 - INFO - The database has been updated successfully!
2024-02-18 01:37:27,904 - INFO - The database has been updated successfully!
2024-02-19 01:35:05,218 - INFO - The database has been updated successfully!
2024-02-20 01:32:15,747 - INFO - The database has been updated successfully!
2024-02-21 01:33:59,318 - INFO - The database has been updated successfully!
2024-02-22 01:32:27,476 - INFO - The database has been updated successfully!
2024-02-23 01:32:07,078 - INFO - The database has been updated successfully!
2024-02-24 01:29:52,304 - INFO - The database has been updated successfully!
2024-02-25 01:36:45,463 - INFO - The database has been updated successfully!
2024-02-26 01:34:56,664 - INFO - The database has been updated successfully!
2024-02-27 01:32:07,798 - INFO - The database has been updated successfully!
2024-02-28 01:33:47,009 - INFO - The database has been updated successfully!
2024-02-29 01:32:05,141 - INFO - The database has been updated successfully!
2024-03-01 01:39:24,127 - INFO - The database has been updated successfully!
2024-03-02 01:30:57,266 - INFO - The database has been updated successfully!
2024-03-03 01:35:50,114 - INFO - The database has been updated successfully!
2024-03-04 01:37:32,767 - INFO - The database has been updated successfully!
2024-03-05 01:32:34,312 - INFO - The database has been updated successfully!
2024-03-06 01:33:16,733 - INFO - The database has been updated successfully!
2024-03-07 01:14:13,177 - INFO - The database has been updated successfully!
2024-03-08 01:32:40,914 - INFO - The database has been updated successfully!
2024-03-09 01:29:48,733 - INFO - The database has been updated successfully!
2024-03-10 01:37:31,347 - INFO - The database has been updated successfully!
2024-03-11 01:33:44,129 - INFO - The database has been updated successfully!
2024-03-12 01:32:23,813 - INFO - The database has been updated successfully!
2024-03-13 01:36:01,643 - INFO - The database has been updated successfully!
2024-03-14 01:33:04,099 - INFO - The database has been updated successfully!
2024-03-15 01:34:20,107 - INFO - The database has been updated successfully!
2024-03-16 01:31:11,631 - INFO - The database has been updated successfully!
2024-03-17 01:37:47,967 - INFO - The database has been updated successfully!
2024-03-18 01:33:57,407 - INFO - The database has been updated successfully!
2024-03-19 01:33:56,494 - INFO - The database has been updated successfully!
2024-03-20 01:33:02,609 - INFO - The database has been updated successfully!
2024-03-21 01:34:46,699 - INFO - The database has been updated successfully!
2024-03-22 01:32:52,765 - INFO - The database has been updated successfully!
2024-03-23 01:31:13,149 - INFO - The database has been updated successfully!
2024-03-24 01:39:38,979 - INFO - The database has been updated successfully!
2024-03-25 01:35:47,368 - INFO - The database has been updated successfully!
2024-03-26 01:33:46,117 - INFO - The database has been updated successfully!
2024-03-27 01:33:58,115 - INFO - The database has been updated successfully!
2024-03-28 01:34:11,020 - INFO - The database has been updated successfully!
2024-03-29 01:33:27,439 - INFO - The database has been updated successfully!
2024-03-30 01:31:10,578 - INFO - The database has been updated successfully!
2024-03-31 01:40:15,133 - INFO - The database has been updated successfully!
2024-04-01 01:41:50,800 - INFO - The database has been updated successfully!
2024-04-02 01:39:02,209 - INFO - The database has been updated successfully!
2024-04-03 01:35:09,547 - INFO - The database has been updated successfully!
2024-04-04 01:35:35,616 - INFO - The database has been updated successfully!
2024-04-05 01:34:54,040 - INFO - The database has been updated successfully!
2024-04-06 01:32:53,954 - INFO - The database has been updated successfully!
2024-04-07 01:40:15,079 - INFO - The database has been updated successfully!
2024-04-08 01:36:21,865 - INFO - The database has been updated successfully!
2024-04-09 01:35:03,445 - INFO - The database has been updated successfully!
2024-04-10 01:34:08,407 - INFO - The database has been updated successfully!
2024-04-11 01:36:02,997 - INFO - The database has been updated successfully!
2024-04-12 01:35:10,537 - INFO - The database has been updated successfully!
2024-04-13 01:16:33,697 - INFO - The database has been updated successfully!
2024-04-14 02:00:53,580 - INFO - The database has been updated successfully!
2024-04-15 02:46:32,155 - INFO - The database has been updated successfully!
2024-04-16 00:49:41,606 - INFO - The database has been updated successfully!
2024-04-17 00:50:09,020 - INFO - The database has been updated successfully!
2024-04-18 00:49:47,233 - INFO - The database has been updated successfully!
2024-04-19 00:49:38,758 - INFO - The database has been updated successfully!
2024-04-20 00:49:25,607 - INFO - The database has been updated successfully!
2024-04-21 00:49:42,137 - INFO - The database has been updated successfully!
2024-04-22 00:49:29,530 - INFO - The database has been updated successfully!
2024-04-23 00:49:28,481 - INFO - The database has been updated successfully!
2024-04-24 00:49:35,911 - INFO - The database has been updated successfully!
2024-04-25 01:12:18,848 - INFO - The database has been updated successfully!
2024-04-26 00:50:08,452 - INFO - The database has been updated successfully!
2024-04-27 00:49:26,649 - INFO - The database has been updated successfully!
2024-04-28 00:49:53,502 - INFO - The database has been updated successfully!
2024-04-29 00:49:34,031 - INFO - The database has been updated successfully!
2024-04-30 00:49:47,079 - INFO - The database has been updated successfully!
2024-05-01 00:52:36,990 - INFO - The database has been updated successfully!
2024-05-02 01:37:27,174 - INFO - The database has been updated successfully!
2024-05-03 01:40:00,435 - INFO - The database has been updated successfully!
2024-05-04 01:36:05,502 - INFO - The database has been updated successfully!
2024-05-05 01:42:07,537 - INFO - The database has been updated successfully!
2024-05-06 01:40:46,820 - INFO - The database has been updated successfully!
2024-05-07 01:39:28,228 - INFO - The database has been updated successfully!
2024-05-08 01:19:03,143 - INFO - The database has been updated successfully!
2024-05-09 01:40:30,562 - INFO - The database has been updated successfully!
2024-05-10 01:40:13,132 - INFO - The database has been updated successfully!
2024-05-11 01:37:36,513 - INFO - The database has been updated successfully!
2024-05-12 01:44:43,744 - INFO - The database has been updated successfully!
2024-05-13 01:41:29,845 - INFO - The database has been updated successfully!
2024-05-14 01:40:20,046 - INFO - The database has been updated successfully!
2024-05-15 01:42:37,245 - INFO - The database has been updated successfully!
2024-05-16 00:49:13,330 - INFO - The database has been updated successfully!
2024-05-17 00:50:12,264 - INFO - The database has been updated successfully!
2024-05-18 00:49:28,435 - INFO - The database has been updated successfully!
2024-05-19 00:49:32,806 - INFO - The database has been updated successfully!
2024-05-20 00:49:30,153 - INFO - The database has been updated successfully!
2024-05-21 00:49:33,869 - INFO - The database has been updated successfully!
2024-05-22 00:49:40,894 - INFO - The database has been updated successfully!
2024-05-23 00:49:29,926 - INFO - The database has been updated successfully!
2024-05-24 00:49:37,227 - INFO - The database has been updated successfully!
2024-05-25 00:49:52,725 - INFO - The database has been updated successfully!
2024-05-26 00:50:03,328 - INFO - The database has been updated successfully!
2024-05-27 00:49:23,845 - INFO - The database has been updated successfully!
2024-05-28 00:49:33,467 - INFO - The database has been updated successfully!
2024-05-29 00:49:55,570 - INFO - The database has been updated successfully!
2024-05-30 00:49:25,157 - INFO - The database has been updated successfully!
2024-05-31 00:49:24,130 - INFO - The database has been updated successfully!
2024-06-01 00:49:41,529 - INFO - The database has been updated successfully!
2024-06-02 00:49:36,690 - INFO - The database has been updated successfully!
2024-06-03 00:49:32,577 - INFO - The database has been updated successfully!
2024-06-04 00:49:32,957 - INFO - The database has been updated successfully!
2024-06-05 00:49:14,878 - INFO - The database has been updated successfully!
2024-06-06 00:49:25,814 - INFO - The database has been updated successfully!
2024-06-07 00:49:35,020 - INFO - The database has been updated successfully!
2024-06-08 00:49:35,311 - INFO - The database has been updated successfully!
2024-06-09 00:49:54,126 - INFO - The database has been updated successfully!
2024-06-10 00:50:07,212 - INFO - The database has been updated successfully!
2024-06-11 00:49:35,108 - INFO - The database has been updated successfully!
2024-06-12 00:50:07,213 - INFO - The database has been updated successfully!
2024-06-13 00:49:30,257 - INFO - The database has been updated successfully!
2024-06-14 00:49:37,060 - ERROR - Error closing cursor
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/pypyodbc.py", line 1617, in execute
    check_success(self, ret)
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/pypyodbc.py", line 1007, in check_success
    ctrl_err(SQL_HANDLE_STMT, ODBC_obj.stmt_h, ret, ODBC_obj.ansi)
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/pypyodbc.py", line 987, in ctrl_err
    raise DatabaseError(state,err_text)
pypyodbc.DatabaseError: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: Error code 0x68')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2204, in _safe_close_cursor
    cursor.close()
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/pypyodbc.py", line 2372, in close
    check_success(self, ret)
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/pypyodbc.py", line 1007, in check_success
    ctrl_err(SQL_HANDLE_STMT, ODBC_obj.stmt_h, ret, ODBC_obj.ansi)
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/pypyodbc.py", line 987, in ctrl_err
    raise DatabaseError(state,err_text)
pypyodbc.DatabaseError: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure')
2024-06-14 00:49:37,061 - ERROR - An exception occurred: Failed to load data into the database
Traceback (most recent call last):
  File "/home/runner/work/ETL_Spotify_data/ETL_Spotify_data/main.py", line 152, in load_to_database
    df_tracks_popularity_table.to_sql('tracks_popularity_table', con=engine, if_exists='append', index=False)
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/pandas/io/sql.py", line 1585, in __exit__
    self.exit_stack.close()
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/contextlib.py", line 540, in close
    self.__exit__(None, None, None)
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/contextlib.py", line 532, in __exit__
    raise exc_details[1]
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/contextlib.py", line 517, in __exit__
    if cb(*exc_details):
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/sqlalchemy/engine/util.py", line 148, in __exit__
    self.rollback()
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/sqlalchemy/engine/util.py", line 144, in __exit__
    self.commit()
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2620, in commit
    self._do_commit()
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2725, in _do_commit
    self._connection_commit_impl()
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2696, in _connection_commit_impl
    self.connection._commit_impl()
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1138, in _commit_impl
    self._handle_dbapi_exception(e, None, None, None, None)
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2347, in _handle_dbapi_exception
    raise exc_info[1].with_traceback(exc_info[2])
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1136, in _commit_impl
    self.engine.dialect.do_commit(self.connection)
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 695, in do_commit
    dbapi_connection.commit()
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/pypyodbc.py", line 2611, in commit
    check_success(self, ret)
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/pypyodbc.py", line 1009, in check_success
    ctrl_err(SQL_HANDLE_DBC, ODBC_obj.dbc_h, ret, ODBC_obj.ansi)
  File "/opt/hostedtoolcache/Python/3.9.19/x64/lib/python3.9/site-packages/pypyodbc.py", line 987, in ctrl_err
    raise DatabaseError(state,err_text)
pypyodbc.DatabaseError: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure')
2024-06-15 00:49:29,222 - INFO - The database has been updated successfully!
2024-06-16 00:49:46,092 - INFO - The database has been updated successfully!
2024-06-17 00:49:34,752 - INFO - The database has been updated successfully!
2024-06-18 00:49:32,832 - INFO - The database has been updated successfully!
